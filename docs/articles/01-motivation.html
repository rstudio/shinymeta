<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>shinymeta overview • shinymeta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="shinymeta overview">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinymeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-code-generation.html">Code generation</a>
    </li>
    <li>
      <a href="../articles/01-motivation.html">shinymeta overview</a>
    </li>
    <li>
      <a href="../articles/02-code-distribution.html">Code distribution</a>
    </li>
    <li>
      <a href="../articles/02-code-generation.html">Code generation</a>
    </li>
    <li>
      <a href="../articles/03-case-studies.html">Case studies</a>
    </li>
    <li>
      <a href="../articles/03-code-distribution.html">Code distribution</a>
    </li>
    <li>
      <a href="../articles/04-case-studies.html">Case studies</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>shinymeta overview</h1>
                        <h4 class="author">Joe Cheng &amp; Carson Sievert</h4>
            
            <h4 class="date">2019-07-01</h4>
      
      
      <div class="hidden name"><code>01-motivation.Rmd</code></div>

    </div>

    
    
<div id="background-motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#background-motivation" class="anchor"></a>Background &amp; motivation</h2>
<p>Since its introduction in 2012, Shiny has become a mainstay of the R ecosystem, providing a solid foundation for building interactive artifacts of all kinds. However, that interactivity has always come at a significant cost to reproducibility, as actions performed in a Shiny app are not easily captured for later analysis and replication.</p>
<p>In 2016, Shiny gained a “bookmarkable state” feature that makes it possible to snapshot and restore application state via URL. Although useful, bookmarking doesn’t completely solve the reproducibility problem, as the actual program logic is still locked behind a user interface.</p>
<!--
Around the same time, Shiny gadgets were introduced, making it possible for Shiny apps to return value(s) to the hosting R session. Although useful for retrieving and exporting R objects from a shiny app, it's really only meant for interactive use (i.e., the same person using the app must be running it in their local R session). In many cases, it'd be more desirable to get at the code to reproduce those objects.
-->
<p>The goal of <strong>shinymeta</strong> is to allow Shiny app authors to present their users with not only the traditional outputs of their analysis (plots, tables, etc.), but also the exact R source code necessary to reproduce that analysis, without any trace of Shiny boilerplate.</p>
<p>For example, below is a screen-recording a <strong>shiny</strong> app, named cranview<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, that allows you to obtain CRAN download statistics for any combination of CRAN packages, look at those downloads at different resolutions, and produce a Rmd-based report with code to reproduce the visualization. Moreover, the R code generated by the shiny app has been tailored so that anyone can re-run the code to get the latest download statistics.</p>
<p><img src="cranview-intro.gif"></p>
<p>Although fairly simple, we hope this example helps to illustrate several reasons why you might want to generate standalone R code that mimics logic in your Shiny app:</p>
<ul>
<li><p><strong>Automation</strong>: Shiny apps often use data that changes over time: stock quotes, sensor readings, centralized databases, etc. By providing users with reproducible R code, you enable them to take that logic into other workflows, such as creating a <a href="https://docs.rstudio.com/connect/1.7.4/user/r-markdown-schedule.html">periodic R Markdown email using RStudio Connect</a>.</p></li>
<li><p><strong>Permanence</strong>: Using a Shiny app can have an ephemeral feeling to it; what happens in the future if the server goes down, or the app’s features change? With a reproducible report, your users can download a more permanent artifact that can be saved locally.</p></li>
<li>
<p><strong>Transparency</strong>: By generating code that exposes the core logic of your <strong>shiny</strong> app, you make things more transparent for yourself and others. This has numerous benefits:</p>
<ul>
<li><p><strong>Reassurance</strong>: In the domain of data analysis, it’s usually enough hard to know exactly how a result is derived, and be confident that it’s 100% correct. Unfortunately, wrapping your analysis code in a user interface like Shiny make the situation even worse: the analysis code is now embedded inside a larger system making the overall logic even more error prone and difficult to fully understand. Export the core logic of your analysis can help reassure others (and yourself!) that your work is correct.</p></li>
<li><p><strong>Education</strong>: For example, in the classroom, a student might use a Shiny app interactively to gain intuitive understanding of a statistical concept, then use the code to learn how to use the corresponding function from their own R scripts.</p></li>
<li><p><strong>Enabling</strong>: Shiny is great for enabling others to interface with an R script you’ve written, but what if your users wish to explore things that your interface doesn’t allow for? By exposing the core logic of your app, you make it easier for motivated users to modify and build upon your work in ways you never thought about.</p></li>
<li><p><strong>Documentation</strong>: This one is especially relevant for exploratory analysis apps that allow you to derive insight from a dataset. A great example is the ANOVA example app in the <a href="04-case-studies.html#ANOVA">case studies vignette</a>, where you can upload a dataset, run an ANOVA analysis, then download a report with all ANOVA results as well as the code to reproduce it.</p></li>
</ul>
</li>
</ul>
</div>
<div id="design-and-implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#design-and-implementation" class="anchor"></a>Design and implementation</h2>
<p>Our goal is to make it possible for a Shiny app to serve two purposes:</p>
<ol style="list-style-type: decimal">
<li>Serving an interactive web application, i.e. its usual purpose</li>
<li>Exposing the essential logic that drives one or more of the app’s outputs, in the form of .R or .Rmd</li>
</ol>
<p>First, can we stop for a moment and recognize that this is a pretty daunting challenge? As it is, Shiny works pretty hard to provide a natural syntax for writing interactive applications. And now, these apps have to not only work, they also need to expose their “essential logic” in a way that can be used outside of Shiny.</p>
<p>Perhaps in the future, someone smarter than your humble author will come up with a silver bullet for achieving perfect reproducibility from any Shiny app with no effort from the app author. But for today, we’re stuck with difficult tradeoffs between:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Quality of output:</strong> Does the generated code look clean, like a human would write it; or is it awkwardly structured and/or contain random boilerplate?</li>
<li>
<strong>Implementation effort:</strong> How hard is it to add code generation to your app?</li>
<li>
<strong>Generality:</strong> Can code generation features be added to <em>any</em> Shiny app, or only apps that follow certain conventions? Does it work as well for large, complex apps as for small ones?</li>
</ol>
<div id="approach-1-copy-and-paste" class="section level3">
<h3 class="hasAnchor">
<a href="#approach-1-copy-and-paste" class="anchor"></a>Approach 1: Copy and paste</h3>
<blockquote>
<p>Quality of output: *****</p>
<p>Ease of learning: ****</p>
<p>Ease of implementation: ** (but highly variable)</p>
<p>Generality: **</p>
</blockquote>
<p>The simplest approach is to simply duplicate your logic. You have an <code>app.R</code> file that contains your Shiny app, and a separate <code>script.R</code> or <code>report.Rmd</code> file that contains the same logic in linear form (i.e. minus any of the structure that Shiny imposes). The <code>script.R</code> or <code>report.Rmd</code> contains placeholders that will be replaced by input values selected by the user.</p>
<p>// TODO: Example</p>
<p>This approach is easy to understand, but it means that you are stuck maintaining a parallel codebase that you must manually keep in sync; over the long term, this can be a source of not only tedium but also bugs. On the plus side, because you’re maintaining <code>script.R</code>/<code>report.Rmd</code> by hand, the level of code quality is limited only by your own skill.</p>
</div>
<div id="approach-2-mechanical-transformation-scriptgloss" class="section level3">
<h3 class="hasAnchor">
<a href="#approach-2-mechanical-transformation-scriptgloss" class="anchor"></a>Approach 2: Mechanical transformation (scriptgloss)</h3>
<blockquote>
<p>Quality of output: **</p>
<p>Ease of learning: ***</p>
<p>Ease of implementation: ****</p>
<p>Generality: **</p>
</blockquote>
<p>This approach automatically transforms your reactives, outputs, and observers into linearized code, using predefined algorithms/heuristics. You as the app author are neither required nor able to influence the code generation process very much. The nice thing about this is how little effort it is—you can add scriptgloss to your app in a couple of minutes!</p>
<p>The price you pay for all this automation is that the generated code looks pretty unnatural, with some Shiny-related wires sticking out. Plus, there are several common situations that will lead to the script not working; then the onus is on either the app author to gain a deeper understanding of scriptgloss and restructure the app to suit, or on the user to take the slightly broken code and fix it.</p>
</div>
<div id="approach-3-metaprogramming-shinymeta" class="section level3">
<h3 class="hasAnchor">
<a href="#approach-3-metaprogramming-shinymeta" class="anchor"></a>Approach 3: Metaprogramming (shinymeta)</h3>
<blockquote>
<p>Quality of output: ****</p>
<p>Ease of learning: **</p>
<p>Ease of implementation: ***</p>
<p>Generality: *****</p>
</blockquote>
<p>Of these three techniques, metaprogramming is by far the most conceptually challenging to get started with. In exchange for climbing the considerable learning curve, you get much more control over how the code output is generated. We also believe (but can’t yet prove) that this approach can scale to larger, more complex apps, including ones that use Shiny modules.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The full source code for this app is located <a href="https://github.com/cpsievert/cranview">here</a>. This app is derived from the original cranview app by David Robinson.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background-motivation">Background &amp; motivation</a></li>
      <li><a href="#design-and-implementation">Design and implementation</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joe Cheng, Carson Sievert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
