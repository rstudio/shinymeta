<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code distribution • shinymeta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Code distribution">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinymeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-code-generation.html">Code generation</a>
    </li>
    <li>
      <a href="../articles/02-code-distribution.html">Code distribution</a>
    </li>
    <li>
      <a href="../articles/03-case-studies.html">Case studies</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Code distribution</h1>
                        <h4 class="author">Carson Sievert &amp; Joe Cheng</h4>
            
            <h4 class="date">2019-07-03</h4>
      
      
      <div class="hidden name"><code>02-code-distribution.Rmd</code></div>

    </div>

    
    
<p>Once you’re able to <a href="01-code-generation.html">generate code</a> that replicates desired logic in your Shiny app, you’ll need some way to distribute the code (and the results!) to users. <strong>shinymeta</strong> provides a few utilties to make all these things a bit easier to implement, including <a href="#bundles">downloading code and results</a> as well as <a href="#show-code">showing code</a> in the Shiny app itself.</p>
<!--
One of the downsides to just showing code is that it doesn't guarantee the result will be reproduced, because the user may not have easy access to a suitable computational environment for running the code. One way to combat this is to provide both the code and the results as one deliverable. Moreover, by leveraging the power of **rmarkdown**, you can insert your code into a larger template that produces a high-quality HTML/pdf/word report of your user's Shiny experience. 
-->
<div id="bundles" class="section level2">
<h2 class="hasAnchor">
<a href="#bundles" class="anchor"></a>Downloading code and results</h2>
<p><strong>shinymeta</strong> provides helpers for generating <a href="https://rmarkdown.rstudio.com/"><strong>rmarkdown</strong> reports</a> from both R scripts (<code><a href="../reference/buildScriptBundle.html">buildScriptBundle()</a></code>) and Rmd templates (<code><a href="../reference/buildScriptBundle.html">buildRmdBundle()</a></code>). Both of these functions use code that you provide to produce a source file, then they (optionally) run <code><a href="https://www.rdocumentation.org/packages/rmarkdown/topics/render">rmarkdown::render()</a></code> on that source file, compress the code &amp; results into a zip file, and provide <code><a href="https://www.rdocumentation.org/packages/shiny/topics/Progress">shiny::Progress</a></code> indications to the user throughout all these steps. These functions are best used inside a <code><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadHandler">downloadHandler()</a></code> that’s linked to either a <code><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadButton">downloadButton()</a></code> or <code><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadButton">downloadLink()</a></code>, so the user can generate and download these reports on demand.</p>
<div id="from-an-r-script" class="section level3">
<h3 class="hasAnchor">
<a href="#from-an-r-script" class="anchor"></a>From an R script</h3>
<p>The <code><a href="../reference/buildScriptBundle.html">buildScriptBundle()</a></code> produces an R script from a code expression. The default behavior is to call <code><a href="https://www.rdocumentation.org/packages/rmarkdown/topics/render">rmarkdown::render()</a></code> on the resulting script, so to customize the resulting output file, you can leverage all it’s support for <a href="https://www.rdocumentation.org/packages/rmarkdown/versions/1.13/topics/compile_notebook">compiling R scripts</a>, such as including markdown and <strong>knitr</strong> chunks in special comments. You can also provide arguments to the <code>render()</code> call through the <code>render_args</code> argument.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shinymeta)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4"></a>ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadButton">downloadButton</a></span>(<span class="st">"download_script"</span>, <span class="st">"Download script"</span>),</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p1"</span>),</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p2"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb1-10"><a href="#cb1-10"></a>  output<span class="op">$</span>p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> carat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>  })</span>
<span id="cb1-13"><a href="#cb1-13"></a>  output<span class="op">$</span>p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> price) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a>  })</span>
<span id="cb1-16"><a href="#cb1-16"></a>  output<span class="op">$</span>download_script &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadHandler">downloadHandler</a></span>(</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="dt">filename =</span> <span class="st">"ggcode.zip"</span>, </span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="dt">content =</span> <span class="cf">function</span>(file) {</span>
<span id="cb1-19"><a href="#cb1-19"></a>      ggcode &lt;-<span class="st"> </span><span class="kw"><a href="../reference/expandCode.html">expandCode</a></span>({</span>
<span id="cb1-20"><a href="#cb1-20"></a>        <span class="st">"#' ---"</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>        <span class="st">"#' title: 'Some ggplot2 code'"</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>        <span class="st">"#' author: ''"</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>        <span class="st">"#' ---"</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="st">"#' Some text that appears above the plot"</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>        <span class="st">"#+ plot, message=FALSE, tidy=TRUE"</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb1-27"><a href="#cb1-27"></a>        gridExtra<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(</span>
<span id="cb1-28"><a href="#cb1-28"></a>          <span class="op">!!</span>output<span class="op">$</span><span class="kw">p1</span>(),</span>
<span id="cb1-29"><a href="#cb1-29"></a>          <span class="op">!!</span>output<span class="op">$</span><span class="kw">p2</span>()</span>
<span id="cb1-30"><a href="#cb1-30"></a>        )</span>
<span id="cb1-31"><a href="#cb1-31"></a>      })</span>
<span id="cb1-32"><a href="#cb1-32"></a>      <span class="kw"><a href="../reference/buildScriptBundle.html">buildScriptBundle</a></span>(</span>
<span id="cb1-33"><a href="#cb1-33"></a>        ggcode, file, </span>
<span id="cb1-34"><a href="#cb1-34"></a>        <span class="dt">render_args =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">output_format =</span> <span class="st">"pdf_document"</span>)</span>
<span id="cb1-35"><a href="#cb1-35"></a>      )</span>
<span id="cb1-36"><a href="#cb1-36"></a>    }</span>
<span id="cb1-37"><a href="#cb1-37"></a>  )</span>
<span id="cb1-38"><a href="#cb1-38"></a>}</span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</span></code></pre></div>
<p><img src="download-script.gif" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="from-an-rmd-template" class="section level3">
<h3 class="hasAnchor">
<a href="#from-an-rmd-template" class="anchor"></a>From an Rmd template</h3>
<p>If you need code spread across multiple chunks in a report, you’ll have to use <code><a href="../reference/buildScriptBundle.html">buildRmdBundle()</a></code> instead of <code><a href="../reference/buildScriptBundle.html">buildScriptBundle()</a></code>, which requires Rmd template file. That template should contain one or more ‘variables’ surrounded in <code>{{}}</code> that match names supplied to <code><a href="../reference/buildScriptBundle.html">buildRmdBundle()</a></code>’s <code>vars</code> argument.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> For example, this template named <code>report.Rmd</code> has two variables, <code>{{plot1}}</code> and <code>{{plot2}}</code>, which we’ll eventually supply with the code from <code>output$p1</code> and <code>output$p2</code>.</p>
<pre>
---
title: "Some ggplot2 code"
author: ""
output: 
  pdf_document: default
  html_document:
    code_folding: "hide"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  out.width="100%", 
  tidy = TRUE
)
```

Here is the first output:

```{r}
{{plot1}}
```

And the second one:

```{r}
{{plot2}}
```
</pre>
<p>Then, to use this <code>report.Rmd</code> template, we could replace <code><a href="../reference/buildScriptBundle.html">buildScriptBundle()</a></code> with this instead:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="../reference/buildScriptBundle.html">buildRmdBundle</a></span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="st">"report.Rmd"</span>, </span>
<span id="cb2-3"><a href="#cb2-3"></a>  file, </span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="dt">vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="dt">plot1 =</span> <span class="kw"><a href="../reference/expandCode.html">expandObjects</a></span>(output<span class="op">$</span>p1),</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="dt">plot2 =</span> <span class="kw"><a href="../reference/expandCode.html">expandObjects</a></span>(output<span class="op">$</span>p2)</span>
<span id="cb2-7"><a href="#cb2-7"></a>  ), </span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="dt">render_args =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="dt">output_format =</span> <span class="st">"all"</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11"></a>)</span></code></pre></div>
</div>
<div id="including-other-files" class="section level3">
<h3 class="hasAnchor">
<a href="#including-other-files" class="anchor"></a>Including other files</h3>
<p>If your report needs access to other files (e.g., data files or images), you’ll want to use the <code>include_files</code> argument. This copies local file(s) over to the (temporary) directory where the report generation occurs and includes them in the final zip bundle. More than likely, you’ll want to use this to include a dataset that your Shiny app has access to, but your users probably don’t. Below is a Shiny app where a user can upload their own dataset, then download that dataset along with some transformation of that dataset.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shinymeta)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sidebarLayout">sidebarLayout</a></span>(</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sidebarPanel">sidebarPanel</a></span>(</span>
<span id="cb3-7"><a href="#cb3-7"></a>      <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fileInput">fileInput</a></span>(<span class="st">"file1"</span>, <span class="st">"Choose CSV File"</span>, <span class="dt">accept =</span> <span class="st">"text/csv"</span>),</span>
<span id="cb3-8"><a href="#cb3-8"></a>      <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/checkboxInput">checkboxInput</a></span>(<span class="st">"header"</span>, <span class="st">"Header"</span>, <span class="dt">value =</span> <span class="ot">TRUE</span>),</span>
<span id="cb3-9"><a href="#cb3-9"></a>      <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/htmlOutput">uiOutput</a></span>(<span class="st">"download_button"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>    ),</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/mainPanel">mainPanel</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/verbatimTextOutput">verbatimTextOutput</a></span>(<span class="st">"summary"</span>))</span>
<span id="cb3-12"><a href="#cb3-12"></a>  )</span>
<span id="cb3-13"><a href="#cb3-13"></a>)</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb3-16"><a href="#cb3-16"></a>  </span>
<span id="cb3-17"><a href="#cb3-17"></a>  data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaReactive.html">metaReactive2</a></span>({</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/req">req</a></span>(input<span class="op">$</span>file1)</span>
<span id="cb3-19"><a href="#cb3-19"></a>    path &lt;-<span class="st"> </span>input<span class="op">$</span>file1<span class="op">$</span>datapath</span>
<span id="cb3-20"><a href="#cb3-20"></a>    filename &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">basename</a></span>(path)</span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="co"># Export code that uses relative paths! 🔥</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>    withr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/withr/topics/with_dir">with_dir</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">dirname</a></span>(path), {</span>
<span id="cb3-23"><a href="#cb3-23"></a>      <span class="kw"><a href="../reference/metaExpr.html">metaExpr</a></span>({</span>
<span id="cb3-24"><a href="#cb3-24"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.csv</a></span>(<span class="op">!!</span>filename, <span class="dt">header =</span> <span class="op">!!</span>input<span class="op">$</span>header)</span>
<span id="cb3-25"><a href="#cb3-25"></a>      })</span>
<span id="cb3-26"><a href="#cb3-26"></a>    })</span>
<span id="cb3-27"><a href="#cb3-27"></a>  })</span>
<span id="cb3-28"><a href="#cb3-28"></a>  </span>
<span id="cb3-29"><a href="#cb3-29"></a>  output<span class="op">$</span>download_button &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/renderUI">renderUI</a></span>({</span>
<span id="cb3-30"><a href="#cb3-30"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/req">req</a></span>(input<span class="op">$</span>file1)</span>
<span id="cb3-31"><a href="#cb3-31"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadButton">downloadButton</a></span>(<span class="st">"download"</span>)</span>
<span id="cb3-32"><a href="#cb3-32"></a>  })</span>
<span id="cb3-33"><a href="#cb3-33"></a>  </span>
<span id="cb3-34"><a href="#cb3-34"></a>  output<span class="op">$</span>summary &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPrint, {</span>
<span id="cb3-35"><a href="#cb3-35"></a>    skimr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/skimr/topics/skim">skim</a></span>(<span class="op">!!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>())</span>
<span id="cb3-36"><a href="#cb3-36"></a>  })</span>
<span id="cb3-37"><a href="#cb3-37"></a>  </span>
<span id="cb3-38"><a href="#cb3-38"></a>  output<span class="op">$</span>download &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/downloadHandler">downloadHandler</a></span>(</span>
<span id="cb3-39"><a href="#cb3-39"></a>    <span class="dt">filename =</span> <span class="st">"report.zip"</span>, </span>
<span id="cb3-40"><a href="#cb3-40"></a>    <span class="dt">content =</span> <span class="cf">function</span>(out) {</span>
<span id="cb3-41"><a href="#cb3-41"></a>      filename &lt;-<span class="st"> </span>input<span class="op">$</span>file1<span class="op">$</span>datapath</span>
<span id="cb3-42"><a href="#cb3-42"></a>      <span class="kw"><a href="../reference/buildScriptBundle.html">buildScriptBundle</a></span>(</span>
<span id="cb3-43"><a href="#cb3-43"></a>        <span class="kw"><a href="../reference/expandCode.html">expandObjects</a></span>(data, output<span class="op">$</span>summary), out, </span>
<span id="cb3-44"><a href="#cb3-44"></a>        <span class="dt">include_files =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/setNames">setNames</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">basename</a></span>(filename), filename)</span>
<span id="cb3-45"><a href="#cb3-45"></a>      )</span>
<span id="cb3-46"><a href="#cb3-46"></a>    }</span>
<span id="cb3-47"><a href="#cb3-47"></a>  )</span>
<span id="cb3-48"><a href="#cb3-48"></a>  </span>
<span id="cb3-49"><a href="#cb3-49"></a>}</span>
<span id="cb3-50"><a href="#cb3-50"></a></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</span></code></pre></div>
<p><img src="upload-download.gif" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="showicode" class="section level2">
<h2 class="hasAnchor">
<a href="#showicode" class="anchor"></a>Showing code</h2>
<div id="for-an-output" class="section level3">
<h3 class="hasAnchor">
<a href="#for-an-output" class="anchor"></a>For an output</h3>
<p>If your Shiny app has lots of outputs, then you may want an intuitive way for users to obtain the code for specific output(s). For this purpose, <strong>shinymeta</strong> provides <code>outputCodeButton()</code>, which wraps an output in a container with a button. The button works in a similar way to an <code><a href="https://www.rdocumentation.org/packages/shiny/topics/actionButton">shiny::actionButton()</a></code>, except the input is determined by the <code>outputId</code> of the shiny output it’s overlaying: <code>input$OUTPUTID_output_code</code>. When this button is clicked, we recommend showing code for an output by supplying that code to <code>displayCodeModal()</code> (which shows a <code><a href="https://www.rdocumentation.org/packages/shiny/topics/modalDialog">shiny::modalDialog()</a></code> that contains a <code><a href="https://www.rdocumentation.org/packages/shinyAce/topics/aceEditor">shinyAce::aceEditor()</a></code>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shinymeta)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb4-4"><a href="#cb4-4"></a>ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="kw">outputCodeButton</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p1"</span>, <span class="dt">height =</span> <span class="dv">200</span>)),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="kw">outputCodeButton</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p2"</span>, <span class="dt">height =</span> <span class="dv">200</span>))</span>
<span id="cb4-7"><a href="#cb4-7"></a>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb4-9"><a href="#cb4-9"></a>  output<span class="op">$</span>p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> carat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a>  })</span>
<span id="cb4-12"><a href="#cb4-12"></a>  output<span class="op">$</span>p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> price) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a>  })</span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>p1_output_code, {</span>
<span id="cb4-16"><a href="#cb4-16"></a>    code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/expandCode.html">expandObjects</a></span>(output<span class="op">$</span>p1, <span class="dt">.pkgs =</span> <span class="st">"ggplot2"</span>)</span>
<span id="cb4-17"><a href="#cb4-17"></a>    <span class="kw">displayCodeModal</span>(code)</span>
<span id="cb4-18"><a href="#cb4-18"></a>  })</span>
<span id="cb4-19"><a href="#cb4-19"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>p2_output_code, {</span>
<span id="cb4-20"><a href="#cb4-20"></a>    code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/expandCode.html">expandObjects</a></span>(output<span class="op">$</span>p2, <span class="dt">.pkgs =</span> <span class="st">"ggplot2"</span>)</span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="kw">displayCodeModal</span>(code)</span>
<span id="cb4-22"><a href="#cb4-22"></a>  })</span>
<span id="cb4-23"><a href="#cb4-23"></a>}</span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</span></code></pre></div>
<p><img src="output-code.gif" width="80%" style="display: block; margin: auto;"></p>
<!--
TODO: 
1. styling the icon?
2. Downloading via icon?
-->
</div>
<div id="numerous-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#numerous-outputs" class="anchor"></a>For numerous outputs</h3>
<p>If you want to show code for a collection of outputs at once, we recommend using a <code><a href="https://www.rdocumentation.org/packages/shiny/topics/actionButton">shiny::actionButton()</a></code> instead of <code>outputCodeButton()</code> to trigger the code display. Note that with <code>displayCodeModal()</code>, you are able to control both the <code><a href="https://www.rdocumentation.org/packages/shiny/topics/modalDialog">modalDialog()</a></code> as well as the <code><a href="https://www.rdocumentation.org/packages/shinyAce/topics/aceEditor">shinyAce::aceEditor()</a></code> that it contains.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shinymeta)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb5-4"><a href="#cb5-4"></a>ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p1"</span>),</span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"p2"</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/actionButton">actionButton</a></span>(<span class="st">"code"</span>, <span class="st">"R code"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/icon">icon</a></span>(<span class="st">"code"</span>))</span>
<span id="cb5-8"><a href="#cb5-8"></a>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb5-10"><a href="#cb5-10"></a>  output<span class="op">$</span>p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> carat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>  })</span>
<span id="cb5-13"><a href="#cb5-13"></a>  output<span class="op">$</span>p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metaRender.html">metaRender</a></span>(renderPlot, {</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="dt">data =</span> diamonds, <span class="dt">x =</span> price) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Number of diamonds"</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a>  })</span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>code, {</span>
<span id="cb5-17"><a href="#cb5-17"></a>    code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/expandCode.html">expandCode</a></span>({</span>
<span id="cb5-18"><a href="#cb5-18"></a>      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb5-19"><a href="#cb5-19"></a>      gridExtra<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(</span>
<span id="cb5-20"><a href="#cb5-20"></a>        <span class="op">!!</span>output<span class="op">$</span><span class="kw">p1</span>(),</span>
<span id="cb5-21"><a href="#cb5-21"></a>        <span class="op">!!</span>output<span class="op">$</span><span class="kw">p2</span>()</span>
<span id="cb5-22"><a href="#cb5-22"></a>      )</span>
<span id="cb5-23"><a href="#cb5-23"></a>    })</span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="kw">displayCodeModal</span>(</span>
<span id="cb5-25"><a href="#cb5-25"></a>      code, </span>
<span id="cb5-26"><a href="#cb5-26"></a>      <span class="dt">title =</span> <span class="st">"ggplot2 code"</span>,</span>
<span id="cb5-27"><a href="#cb5-27"></a>      <span class="dt">size =</span> <span class="st">"s"</span>, </span>
<span id="cb5-28"><a href="#cb5-28"></a>      <span class="dt">fontSize =</span> <span class="dv">16</span>, </span>
<span id="cb5-29"><a href="#cb5-29"></a>      <span class="dt">height =</span> <span class="st">"200px"</span>,</span>
<span id="cb5-30"><a href="#cb5-30"></a>      <span class="dt">theme =</span> <span class="st">"solarized_dark"</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    )</span>
<span id="cb5-32"><a href="#cb5-32"></a>  })</span>
<span id="cb5-33"><a href="#cb5-33"></a>}</span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</span></code></pre></div>
<p><img src="show-code.gif" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Instead of using <a href="https://bookdown.org/yihui/rmarkdown/parameterized-reports.html">parameterized reports</a> (i.e., the usual way to <a href="https://shiny.rstudio.com/articles/generating-reports.html">generate downloadable reports</a>), <code><a href="../reference/buildScriptBundle.html">buildRmdBundle()</a></code> uses <code><a href="https://www.rdocumentation.org/packages/knitr/topics/knit_expand">knitr::knit_expand()</a></code> to fill in the Rmd template, so the user gets not only the report, but also the source file with the essential logic to reproduce that report.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#bundles">Downloading code and results</a></li>
      <li><a href="#showicode">Showing code</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joe Cheng, Carson Sievert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
